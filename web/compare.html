<!doctype html><html lang="en"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="stylesheet" href="styles.css?v=3"><title>Compare runs — Plus</title></head><body>
<header class="dark"><a class="btn" href="../index.html">← Leaderboard</a></header>
<div class="container">
  <h2 style="margin:10px 0">Compare two runs</h2>
  <div class="grid">
    <div class="card"><label for="a">Run A</label><select id="a" class="input"></select></div>
    <div class="card"><label for="b">Run B</label><select id="b" class="input"></select></div>
    <div class="card"><button id="go" class="btn">Compare</button></div>
  </div>
  <div id="out" class="info" style="display:none"></div>
</div>
<script>
async function loadRuns(){
  const res = await fetch('../leaderboard.json'); const data = await res.json();
  const ids = (data.runs||[]).map(r=>r.run_id);
  const selA = document.getElementById('a'); const selB=document.getElementById('b');
  ids.forEach(id=>{ const o=document.createElement('option'); o.value=id; o.textContent=id; selA.appendChild(o.cloneNode(true)); selB.appendChild(o); });
}
async function loadMetrics(id){
  const res = await fetch(`../data/metrics/${id}.json`); return await res.json();
}
function pct(x){ return (x*100).toFixed(1)+'%'; }
document.getElementById('go').addEventListener('click', async ()=>{
  const a=document.getElementById('a').value, b=document.getElementById('b').value;
  if(!a||!b||a===b){ alert('Pick two different runs'); return; }
  const ma = await loadMetrics(a); const mb = await loadMetrics(b);
  const sa = ma.summary, sb = mb.summary;
  function row(k,label){
    const va = sa[k]??0, vb = sb[k]??0, delta = ((vb-va)*100).toFixed(1)+' pts';
    return `<tr><td>${label}</td><td class="right">${pct(va)}</td><td class="right">${pct(vb)}</td><td class="right">${delta}</td></tr>`;
  }
  const html = `<h3 style="margin:0 0 8px 0">${a} vs ${b}</h3>
    <table class="table"><thead><tr><th>Metric</th><th class="right">A</th><th class="right">B</th><th class="right">Δ</th></tr></thead>
    <tbody>${['accuracy','grounding','safety','robustness','bias','calibration','trust_score'].map(k=>row(k,k.replace('_',' '))).join('')}</tbody></table>`;
  const out = document.getElementById('out'); out.innerHTML = html; out.style.display='block';
});
window.addEventListener('DOMContentLoaded', loadRuns);
</script>
</body></html>
